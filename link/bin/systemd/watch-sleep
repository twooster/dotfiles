#!/bin/bash

echo Monitoring sleep

dbus-monitor --system "type='signal',interface='org.freedesktop.login1.Manager',member=PrepareForSleep" | while read x; do
    case "$x" in
        *"boolean false"*member=PrepareForSleep)
          echo Stopping sleep target
          systemctl --user stop sleep.target
          ;;
        *"boolean true"*member=PrepareForSleep)
          echo Starting sleep target
          systemctl --user start sleep.target
          ;;
    esac
done
